# 해결 기록: CSPIN-입금-인출-로직-수정

> **원본 지시서:** `instructions/CSPIN-입금-인출-로직-수정_20251020_120000.md`
> **관련 커밋:** (아직 없음)
> **최종 버전:** v1.1.8

---

### 1. 해결 방법 요약

CSPIN 토큰 입금 시 제톤 전송 페이로드 수정, CSPIN 입출 테스트 버튼 삭제, CSPIN 인출 로직을 백엔드 호출로 변경하여 정상적인 제톤 전송 구현.

- `src/components/Game.tsx`: buildCSPINTransferPayload forward_payload 수정, CSPIN 인출 테스트 버튼 삭제, handleWithdraw 백엔드 호출로 변경.
- `docs/ssot/[산출물3]핵심-로직-의사코드-(MVP-확장-v2.0).md`: CSPIN 입금/인출 로직 추가.
- `CHANGELOG.md`: v1.1.8 업데이트.
- `.gitignore`: ton-docs, token-contract, jetton-contract, sdk 폴더 제외.

---

### 2. 핵심 코드 변경 사항

- buildCSPINTransferPayload: forward_payload를 right$1 nothing$0로 수정하여 TL-B 준수.
- CSPIN 입금: 제톤 월렛 주소로 transfer 메시지 전송.
- CSPIN 인출: 프론트엔드에서 백엔드 /api/initiate-withdrawal 호출.
- 테스트 버튼 삭제.

---

### 3. 참고 사항

- 제톤 전송은 제톤 월렛 컨트랙트에 transfer 메시지 전송.
- TON Connect에서 제톤 전송 지원 시 CSPIN 토큰 표시.
- 인출은 게임 월렛 프라이빗 키로 서명하여 전송.

---

### 4. 후임 AI를 위한 인수인계

- CSPIN 입금: 사용자의 제톤 월렛 → 게임 지갑.
- CSPIN 인출: 게임 지갑 → 사용자 지갑 (백엔드 처리).
- 페이로드는 jetton.tlb 기반 beginCell 빌드.</content>
<parameter name="filePath">c:\Users\x0051\Desktop\DEV\새 폴더\CandleSpinner\solutions\CSPIN-입금-인출-로직-수정_20251020_120000_solution.md