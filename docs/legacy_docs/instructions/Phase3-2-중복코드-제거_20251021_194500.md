# ëª…ë ¹ ì§€ì‹œì„œ: Phase 3-2 ì¤‘ë³µ ì½”ë“œ ì œê±° ë° ì»¤ìŠ¤í…€ Hooks ì¶”ì¶œ

**ì‘ì—… ID**: Phase 3-2  
**íƒ€ì„ìŠ¤íƒ¬í”„**: 2025-10-21 19:45:00  
**ìš”ì²­ì**: User  
**ë‹´ë‹¹**: AI Agent

---

## ğŸ“‹ ìš”ì²­ ì‚¬í•­

**í”„ë¡œì íŠ¸ì˜ ê¸°ìˆ  ë¶€ì±„ë¥¼ í•´ê²°**í•˜ê³  **ì½”ë“œ ì¬ì‚¬ìš©ì„±ì„ ê·¹ëŒ€í™”**í•©ë‹ˆë‹¤.

### ëª©í‘œ
- 20%+ ì¤‘ë³µ ì½”ë“œ ì œê±°
- 4ê°œ ì´ìƒ ì»¤ìŠ¤í…€ hooks ì¶”ì¶œ
- ìƒíƒœ ê´€ë¦¬ ë¡œì§ í†µì¼
- ì»´í¬ë„ŒíŠ¸ í¬ê¸° 40% ê°ì†Œ

---

## ğŸ¯ ì‹ë³„ëœ ì¤‘ë³µ ì½”ë“œ & í•´ê²°ì±…

### 1. Telegram WebApp ì´ˆê¸°í™” ì¤‘ë³µ

**í˜„ì¬ ë¬¸ì œ**:
- `src/components/Game.tsx`, `src/components/Deposit.tsx`, `src/utils/telegram.ts`ì—ì„œ ì¤‘ë³µ

**í•´ê²°ì±…**:
```typescript
// src/hooks/useTelegramWebApp.ts ìƒì„±
export function useTelegramWebApp() {
  const [webApp, setWebApp] = useState<TelegramWebApp | undefined>();
  
  useEffect(() => {
    const tma = getTelegramWebApp();
    if (tma) {
      initializeTelegramWebApp();
      setWebApp(tma);
    }
  }, []);
  
  return webApp;
}
```

### 2. ê²Œì„ ìƒíƒœ ê´€ë¦¬ ì¤‘ë³µ

**í˜„ì¬ ë¬¸ì œ**:
- `Game.tsx`: Zustand ìŠ¤í† ì–´ + useState í˜¼ìš©
- `Deposit.tsx`: ë¹„ìŠ·í•œ ìƒíƒœ íŒ¨í„´ ë°˜ë³µ

**í•´ê²°ì±…**:
```typescript
// src/hooks/useGameState.ts ìƒì„±
export function useGameState() {
  const [userCredit, setUserCredit] = useState(1000);
  const [betAmount, setBetAmount] = useState(100);
  const [isSpinning, setIsSpinning] = useState(false);
  
  const updateCredit = useCallback((amount: number) => {
    setUserCredit(prev => Math.max(0, prev + amount));
  }, []);
  
  return { userCredit, betAmount, isSpinning, updateCredit, setBetAmount, setIsSpinning };
}
```

### 3. ì…ê¸ˆ ìƒíƒœ ê´€ë¦¬ ì¤‘ë³µ

**í˜„ì¬ ë¬¸ì œ**:
- `Deposit.tsx`ì˜ ì…ê¸ˆ ë°©ì‹ ì„ íƒ, ë¡œë”©, ì—ëŸ¬ ìƒíƒœê°€ ë¶„ì‚°

**í•´ê²°ì±…**:
```typescript
// src/hooks/useDepositState.ts ìƒì„±
export function useDepositState() {
  const [depositMethod, setDepositMethod] = useState<DepositMethod>('tonconnect');
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState<string | null>(null);
  
  const handleError = useCallback((err: unknown) => {
    const message = getErrorMessage(err);
    setError(message);
  }, []);
  
  return { depositMethod, setDepositMethod, loading, setLoading, error, handleError };
}
```

### 4. ë©”ì‹œì§€/í† ìŠ¤íŠ¸ ìƒíƒœ ì¤‘ë³µ

**í˜„ì¬ ë¬¸ì œ**:
- `message`, `messageType` ë¶„ë¦¬ëœ ìƒíƒœ (ë¶ˆì¼ì¹˜ ìœ„í—˜)
- ì—¬ëŸ¬ ì»´í¬ë„ŒíŠ¸ì—ì„œ ìœ ì‚¬ íŒ¨í„´

**í•´ê²°ì±…**:
```typescript
// src/hooks/useToast.ts ìƒì„±
export function useToast() {
  const [toast, setToast] = useState<ToastMessage | null>(null);
  
  const showToast = useCallback((
    message: string,
    type: 'success' | 'error' | 'warning' | 'info' = 'info',
    duration = 3000
  ) => {
    const id = Math.random().toString(36).slice(2);
    setToast({ id, message, type, duration });
    setTimeout(() => setToast(null), duration);
  }, []);
  
  return { toast, showToast };
}
```

### 5. ì—ëŸ¬ ì²˜ë¦¬ íŒ¨í„´ ì¤‘ë³µ

**í˜„ì¬ ë¬¸ì œ**:
- ê° ì»´í¬ë„ŒíŠ¸ì—ì„œ try-catch ë¡œì§ ë°˜ë³µ
- Sentry ë³´ê³ ì™€ UI í”¼ë“œë°±ì´ ë¶„ë¦¬

**í•´ê²°ì±…**:
```typescript
// src/hooks/useAsyncHandler.ts ìƒì„±
export function useAsyncHandler() {
  const { showToast } = useToast();
  
  return useCallback(async <T,>(
    asyncFn: () => Promise<T>,
    options?: { onSuccess?: (data: T) => void; onError?: (err: Error) => void }
  ) => {
    try {
      const result = await asyncFn();
      options?.onSuccess?.(result);
      return result;
    } catch (err) {
      const error = err instanceof Error ? err : new Error(String(err));
      const message = getErrorMessage(error);
      showToast(message, 'error');
      Sentry.captureException(error);
      options?.onError?.(error);
      throw error;
    }
  }, [showToast]);
}
```

---

## ğŸ“ êµ¬í˜„ ê³„íš

| ë‹¨ê³„ | íŒŒì¼ | ì‘ì—… | ìƒíƒœ |
|------|------|------|------|
| 1 | `src/hooks/useTelegramWebApp.ts` | TMA ì´ˆê¸°í™” hook | â³ |
| 2 | `src/hooks/useGameState.ts` | ê²Œì„ ìƒíƒœ hook | â³ |
| 3 | `src/hooks/useDepositState.ts` | ì…ê¸ˆ ìƒíƒœ hook | â³ |
| 4 | `src/hooks/useToast.ts` | í† ìŠ¤íŠ¸ ì•Œë¦¼ hook | â³ |
| 5 | `src/hooks/useAsyncHandler.ts` | ë¹„ë™ê¸° í•¸ë“¤ëŸ¬ hook | â³ |
| 6 | `src/components/Game.tsx` | hook ì ìš© | â³ |
| 7 | `src/components/Deposit.tsx` | hook ì ìš© | â³ |
| 8 | í…ŒìŠ¤íŠ¸ & ë¹Œë“œ | ê²€ì¦ | â³ |

---

## âœ… ì™„ë£Œ ê¸°ì¤€

- [ ] 5ê°œ ì»¤ìŠ¤í…€ hooks ìƒì„±
- [ ] ì¤‘ë³µ ì½”ë“œ 20% ì´ìƒ ì œê±°
- [ ] Game.tsx ì½”ë“œ ë¼ì¸ 40% ê°ì†Œ
- [ ] Deposit.tsx ì½”ë“œ ë¼ì¸ 30% ê°ì†Œ
- [ ] TypeScript íƒ€ì… ê²€ì‚¬: 0 errors
- [ ] npm test í†µê³¼ (12/12)
- [ ] npm run build ì„±ê³µ
- [ ] Git ì»¤ë°‹ ì™„ë£Œ (version bump: v2.4.0)

---

## ğŸ“Š ì˜ˆìƒ ê°œì„  íš¨ê³¼

### Before (í˜„ì¬)
```
Game.tsx: ~150 ë¼ì¸ (ì¤‘ë³µ ìƒíƒœ ê´€ë¦¬)
Deposit.tsx: ~200 ë¼ì¸ (ì…ê¸ˆ ë¡œì§ í˜¼í•©)
ì»´í¬ë„ŒíŠ¸ ë³µì¡ë„: ë†’ìŒ
ì¬ì‚¬ìš©ì„±: ë‚®ìŒ
```

### After (ê°œì„  í›„)
```
Game.tsx: ~90 ë¼ì¸ (40% ê°ì†Œ)
Deposit.tsx: ~140 ë¼ì¸ (30% ê°ì†Œ)
hooks/: 200+ ë¼ì¸ (ì¬ì‚¬ìš© ê°€ëŠ¥)
ì»´í¬ë„ŒíŠ¸ ë³µì¡ë„: ì¤‘ê°„
ì¬ì‚¬ìš©ì„±: ë†’ìŒ
```

---

**Status**: ğŸ“‹ ì§€ì‹œì„œ ìƒì„± ì™„ë£Œ  
**ë‹¤ìŒ ë‹¨ê³„**: Step 3 - ì»¤ìŠ¤í…€ hooks êµ¬í˜„
