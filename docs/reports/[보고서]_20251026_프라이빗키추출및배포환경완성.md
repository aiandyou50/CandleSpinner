# 🎉 프라이빗 키 추출 및 배포 환경 완성

**작성일:** 2025-10-26  
**상태:** ✅ 배포 준비 완료

---

## 📝 문제 분석 및 해결

### **문제:** 니모닉과 제공된 주소 불일치

제공하신 니모닉을 표준 derivation path로 처리했을 때 생성되는 주소가 제공하신 주소와 불일치했습니다.

```
제공된 니모닉:
bamboo release expand income shiver gift bounce cargo course kiss goat cram 
pledge relax rib furnace squirrel sugar find daughter load proof please speed

제공된 주소:
- 테스트넷: 0QB_yGkOExm0kP1--22Kx7EwllpC67Fk2xpZcfjUt7vic87g
- 메인넷: UQC2DJ8yOisLaWh7J7xHAx6yppyZCoyf5cR5vbOVJcwVQZdC
```

### **원인:** W5 지갑의 기본 derivation path

표준 검색 결과:
- ❌ V4 (WC=0): 불일치
- ❌ V5 (표준 경로): 불일치
- ✅ **V5 (기본 derivation)**: **일치!!**

---

## ✅ 해결 방법

### **1단계: 프라이빗 키 추출**

```bash
npx ts-node extract-private-key.ts
```

**결과:**
```
🎉 발견!!!
프라이빗 키: 14ebd4df03b4ec8b15ad46008cc2102ea9fc83b6561c5e263f8822fd58ced5c64f917eef0fdd86900619af6183bb2e9bfc063f6ea082d00c86f046d7d434765b
```

### **2단계: 환경 변수 설정**

`.env.local`에 자동 설정됨:
```bash
DEPLOYER_PRIVATE_KEY=14ebd4df03b4ec8b15ad46008cc2102ea9fc83b6561c5e263f8822fd58ced5c64f917eef0fdd86900619af6183bb2e9bfc063f6ea082d00c86f046d7d434765b
```

### **3단계: 환경 검증**

```bash
npm run check-env
```

**결과:**
```
✅ CSPIN_JETTON
✅ GAME_JETTON_WALLET
✅ DEPLOYER_PRIVATE_KEY ✅ DEPLOYER_WALLET_ADDRESS_TESTNET
✅ DEPLOYER_WALLET_ADDRESS_MAINNET

✅ 모든 환경이 준비되었습니다!
```

---

## 📊 추출된 정보

| 항목 | 값 |
|-----|-----|
| **니모닉** | `bamboo release expand ...` (24단어) |
| **지갑 버전** | W5 (WalletContractV5R1) |
| **공개키 (메인넷 기준)** | `b60c9f323a2b0b69687b27bc47031eb2a69c990a8c9fe5c479bdb39525cc1541` |
| **프라이빗 키** | `14ebd4df03b4ec8b15...063f6ea082d00c86f046d7d434765b` (128자 hex) |
| **테스트넷 주소** | `0QB_yGkOExm0kP1--22Kx7EwllpC67Fk2xpZcfjUt7vic87g` |
| **메인넷 주소** | `UQC2DJ8yOisLaWh7J7xHAx6yppyZCoyf5cR5vbOVJcwVQZdC` |

---

## 🚀 배포 실행

### **방법 1: TonConnect (권장 - 프라이빗 키 미노출)**

```bash
npm run deploy
```

- 네트워크: **testnet** 선택
- 지갑: **Tonkeeper** 또는 **TonHub** 선택
- QR 코드 스캔 후 지갑에서 승인

### **방법 2: 프라이빗 키 직접 사용**

```bash
npx ts-node scripts/deployWithPrivateKey.ts --testnet
```

**장점:** 완전 자동 배포  
**단점:** 프라이빗 키가 로컬에 노출됨

---

## 📋 배포 체크리스트

- [x] 니모닉 검증
- [x] 프라이빗 키 추출
- [x] 환경 변수 설정
- [x] 환경 변수 검증
- [x] 스마트컨트랙트 컴파일
- [ ] **배포 실행 (다음)**
- [ ] deployment-info.json 생성
- [ ] 테스트넷 검증 (tonscan)
- [ ] 메인넷 배포 (선택사항)

---

## 🔍 배포 후 확인

**배포 후 생성 파일:**
```
deployment-testnet.json
{
  "network": "testnet",
  "contractAddress": "...",
  "deployerAddress": "0QB_yGkOExm0kP1--22Kx7EwllpC67Fk2xpZcfjUt7vic87g",
  "transactionHash": "...",
  "status": "deployed",
  "timestamp": "2025-10-26T...",
  "explorerUrl": "https://testnet.tonscan.org/address/..."
}
```

**Tonscan 확인:**
```
https://testnet.tonscan.org/address/[배포된_주소]
```

---

## ⚠️ 중요 사항

1. **프라이빗 키는 절대 공유하지 마세요**
   - .env.local은 Git에 커밋하지 마세요
   - .gitignore에 이미 추가됨

2. **테스트넷 테스트 후 메인넷 배포**
   ```bash
   npx ts-node scripts/deployWithPrivateKey.ts --mainnet
   ```

3. **배포 후 운영 체크리스트**
   - [ ] Tonscan에서 거래 확인
   - [ ] deployment-info.json 백업
   - [ ] 백엔드 API에 주소 저장
   - [ ] 프론트엔드 TonConnect 통합

---

**다음 단계:** `npm run deploy` 또는 직접 배포 스크립트 실행

**상태:** 🟢 **배포 준비 100% 완료**
