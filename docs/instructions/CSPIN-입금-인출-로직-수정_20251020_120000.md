# CSPIN 입금/인출 로직 수정 및 테스트 버튼 삭제

> **원본 명령:** 사용자의 쿼리 기반

> **관련 커밋:** (아직 없음)

> **최종 버전:** v1.1.2 (예상)

---

### 1. 해결 방법 요약

CSPIN 토큰 입금 시 제톤 전송 페이로드 수정, CSPIN 입출 테스트 버튼 삭제, CSPIN 입금 버튼 정상화, CSPIN 인출 로직 수정.

- `src/components/Game.tsx`: buildCSPINTransferPayload 함수 수정 (forward_payload TL-B 구조 수정), CSPIN 입출 테스트 버튼 삭제, CSPIN 입금 버튼 로직 확인, CSPIN 인출 로직 수정 (백엔드 호출).
- `docs/ssot/[산출물3]핵심-로직-의사코드-(MVP-확장-v2.0).md`: 변경 사항 동기화.

---

### 2. 핵심 코드 변경 사항

- buildCSPINTransferPayload: forward_payload를 right$1 nothing$0 ^Cell로 수정.
- CSPIN 입금: 제톤 월렛 주소로 전송 확인.
- CSPIN 인출: 백엔드 /api/initiate-withdrawal 호출로 수정.
- 테스트 버튼 삭제.

---

### 3. 참고 사항

- 제톤 전송 TL-B 구조 준수.
- TON Connect에서 제톤 전송 지원 확인.
- 인출은 백엔드에서 게임 월렛 프라이빗 키로 서명하여 전송.

---

### 4. 후임 AI를 위한 인수인계

- 제톤 전송은 제톤 월렛 컨트랙트에 transfer 메시지 전송.
- payload는 jetton.tlb 기반 beginCell로 빌드.
- 인출은 오프체인에서 처리하여 수수료 절감.</content>
<parameter name="filePath">c:\Users\x0051\Desktop\DEV\새 폴더\CandleSpinner\instructions\CSPIN-입금-인출-로직-수정_20251020_120000.md