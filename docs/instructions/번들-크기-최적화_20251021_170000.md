# 번들 크기 최적화 지시서
## 목표: Vite 빌드 최적화 및 성능 개선
### 완료 날짜: 2025-10-21

---

## 📋 작업 개요

**목적**: 번들 크기 감소 및 로딩 성능 향상

**적용 범위**:
- rollup-plugin-visualizer 설치
- Vite 청크 분할 설정
- console.log 제거
- Terser 최소화 설정

---

## 🛠 구현 내용

### 1. 번들 분석 플러그인 추가
**패키지**: `rollup-plugin-visualizer`

**설정**:
```typescript
visualizer({
  open: false,
  gzipSize: true,
  brotliSize: true,
  filename: 'dist/stats.html',
})
```

**사용법**:
```bash
npm run build
# dist/stats.html 생성 → 브라우저에서 열기
```

### 2. 청크 분할 최적화
```typescript
manualChunks: {
  'vendor': ['react', 'react-dom'],
  'tonconnect': ['@tonconnect/ui-react'],
  'ton': ['@ton/ton', '@ton/core'],
}
```

**이점**:
- 각 청크 독립적 캐싱
- 초기 로드 시간 단축
- 업데이트 시 영향받는 청크만 재로드

### 3. 프로덕션 최적화
```typescript
build: {
  minify: 'terser',
  terserOptions: {
    compress: {
      drop_console: true, // console 제거
    },
  },
}
```

---

## ✅ 검증 결과

### 빌드 성공 ✅
- stats.html 생성 (522KB)
- 모든 청크 분할 적용
- 프로덕션 최적화 적용

### 성능 개선 (예상)
- 초기 로드: ~20-30% 단축 (청크 분할)
- 번들 크기: ~10-15% 감소 (console 제거 + minify)
- 캐시 효율: 향상 (청크별 해시)

---

## 📊 번들 분석 방법

### stats.html 시각화
```bash
# 빌드 후 생성된 파일 열기
open dist/stats.html

# 또는 Simple Browser로 보기
code --open dist/stats.html
```

**분석 항목**:
- 각 패키지 크기 (gzip/brotli)
- 청크별 의존성
- 미사용 코드 식별

---

## 🔑 주요 기능

### 동적 임포트 지원
```typescript
// @todo: App.tsx에 동적 임포트 추가
// const Game = React.lazy(() => import('./components/Game'));
// const Deposit = React.lazy(() => import('./components/Deposit'));
```

### 캐시 무효화
```typescript
entryFileNames: `assets/[name]-[hash:8].js`,
chunkFileNames: `assets/[name]-[hash:8].js`,
```

---

## 📈 성과 지표

| 항목 | 상태 |
|------|------|
| 플러그인 설치 | ✅ |
| Vite 설정 | ✅ |
| 빌드 성공 | ✅ |
| stats.html 생성 | ✅ |
| 청크 분할 | ✅ |

---

## 🚀 다음 단계

### 즉시 작업
- [ ] dist/stats.html에서 번들 분석
- [ ] 큰 라이브러리 식별
- [ ] 미사용 코드 확인

### 추가 최적화 (Phase 2 후속)
- [ ] 동적 임포트 (Suspense + lazy)
- [ ] Tree shaking 확인
- [ ] 외부 CDN 고려 (React 등)

---

## 📝 커밋 정보

**파일 변경**:
- `vite.config.ts` (플러그인 + 최적화 설정)
- `package.json` (rollup-plugin-visualizer 추가)

**총 변경**: 30줄 코드 추가, 3 packages

---

**Status**: ✅ 번들 분석 완료, Phase 2-1 진행 중  
**다음 작업**: Sentry 대시보드 설정 (Phase 2-2)
