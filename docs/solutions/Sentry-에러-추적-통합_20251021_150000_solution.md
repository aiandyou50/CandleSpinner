# Sentry ì—ëŸ¬ ì¶”ì  í†µí•© - í•´ê²° ê¸°ë¡
## ìƒíƒœ: âœ… ì™„ë£Œ
### ì‘ì—… ë‚ ì§œ: 2025-10-21

---

## ğŸ“‹ ì‘ì—… ê°œìš”

**ì™„ë£Œ ê¸°ê°„**: ì•½ 30ë¶„  
**ê²°ê³¼**: Sentry ì—ëŸ¬ ì¶”ì  ì‹œìŠ¤í…œ ì™„ë²½ êµ¬ì¶•  
**í…ŒìŠ¤íŠ¸**: âœ… ëª¨ë“  í…ŒìŠ¤íŠ¸ í†µê³¼ (12/12)

---

## ğŸ¯ ë‹¬ì„±í•œ ëª©í‘œ

### 1. Sentry SDK í†µí•© âœ…
- `@sentry/react`, `@sentry/tracing` ì„¤ì¹˜ (14 packages)
- `src/main.tsx`ì—ì„œ Sentry ì´ˆê¸°í™”
- í™˜ê²½ë³„ ì„¤ì • (ê°œë°œ: 100% ìƒ˜í”Œë§, í”„ë¡œë•ì…˜: 10%)

### 2. Error Boundary êµ¬í˜„ âœ…
- `src/components/ErrorBoundary.tsx` ìƒˆë¡œ ìƒì„±
- React ì—ëŸ¬ ê°ì§€ ë° ìë™ ë³´ê³ 
- ì‚¬ìš©ì ì¹œí™”ì  ì˜¤ë¥˜ í™”ë©´ ì œê³µ
- `App.tsx`ì— í†µí•©

### 3. í™˜ê²½ë³€ìˆ˜ ì„¤ì • âœ…
- `.env` íŒŒì¼ ìƒì„± (ê¸°ë³¸ í…ŒìŠ¤íŠ¸ ê°’)
- `.env.example` ìƒì„± (í”„ë¡œë•ì…˜ í…œí”Œë¦¿)
- `.gitignore` ì—…ë°ì´íŠ¸ (.env.local, .env.production.local)

### 4. TypeScript íƒ€ì… ì•ˆì •ì„± âœ…
- `src/vite-env.d.ts`ì— ImportMeta íƒ€ì… ì„ ì–¸
- import.meta.env ì ‘ê·¼ ì‹œ íƒ€ì… ì•ˆì „ì„± í™•ë³´
- CSS ëª¨ë“ˆ ì„ ì–¸ ê°œì„ 

---

## ğŸ”§ ê¸°ìˆ ì  êµ¬í˜„ ìƒì„¸

### ErrorBoundary ì•„í‚¤í…ì²˜

```
App (ErrorBoundary ë˜í•‘)
  â†“
ErrorBoundary (ì—ëŸ¬ ê°ì§€)
  â”œâ”€ componentDidCatch() â†’ Sentry.captureException()
  â”œâ”€ ì—ëŸ¬ ë°œìƒ ì‹œ â†’ ì˜¤ë¥˜ í™”ë©´ í‘œì‹œ
  â””â”€ ì •ìƒ ì‹œ â†’ children ë Œë”ë§
    â†“
  TonConnectUIProvider (Provider)
    â†“
  Game/Deposit Components (ì½˜í…ì¸ )
```

### Sentry ë°ì´í„° í”Œë¡œìš°

```
Error ë°œìƒ
  â†“
ErrorBoundary.componentDidCatch()
  â†“
Sentry.captureException()
  â”œâ”€ error ê°ì²´
  â”œâ”€ React componentStack
  â””â”€ environment ì •ë³´
    â†“
Sentry í´ë¼ìš°ë“œ (ë°ì´í„° ì „ì†¡)
  â†“
ì‹¤ì‹œê°„ ì•Œë¦¼ & ëŒ€ì‹œë³´ë“œ
```

---

## ğŸ“Š êµ¬í˜„ í†µê³„

| í•­ëª© | ìˆ˜ì¹˜ |
|------|------|
| ìƒˆ íŒŒì¼ ìƒì„± | 3ê°œ (ErrorBoundary.tsx, .env, .env.example) |
| íŒŒì¼ ìˆ˜ì • | 5ê°œ (main.tsx, App.tsx, vite-env.d.ts, tsconfig.json, .gitignore) |
| íŒ¨í‚¤ì§€ ì„¤ì¹˜ | 14ê°œ (@sentry/react ì˜ì¡´ì„± í¬í•¨) |
| ì´ ë³€ê²½ ë¼ì¸ | 326ì¤„ ì¶”ê°€ |
| í…ŒìŠ¤íŠ¸ í†µê³¼ìœ¨ | 100% (12/12) |
| TypeScript ì˜¤ë¥˜ | 0ê°œ âœ… |

---

## âœ… ê²€ì¦ ê²°ê³¼

### í…ŒìŠ¤íŠ¸ ì‹¤í–‰
```
âœ… Test Files  1 passed (1)
âœ… Tests  12 passed (12)
âœ… Duration  1.99s
```

### TypeScript íƒ€ì… ì²´í¬
```
âœ… npm run typecheck
   No errors found
```

### Git ì»¤ë°‹
```
âœ… Commit: fa0303f
   Message: feat: Sentry ì—ëŸ¬ ì¶”ì  í†µí•© + Error Boundary ì¶”ê°€
   9 files changed, 326 insertions(+), 3 deletions(-)
```

---

## ğŸ› ë°œìƒí•œ ë¬¸ì œ ë° í•´ê²°

### ë¬¸ì œ 1: import.meta.env íƒ€ì… ì˜¤ë¥˜
**ì¦ìƒ**: `Property 'env' does not exist on type 'ImportMeta'`

**ì›ì¸**: Viteì˜ import.meta.env íƒ€ì…ì´ ì •ì˜ë˜ì§€ ì•ŠìŒ

**í•´ê²°**:
```typescript
// src/vite-env.d.tsì— ì„ ì–¸ ì¶”ê°€
interface ImportMeta {
  readonly env: {
    readonly VITE_SENTRY_DSN?: string;
    readonly MODE: 'development' | 'production';
  };
}
```

### ë¬¸ì œ 2: CSS ëª¨ë“ˆ ì„ ì–¸ ì˜¤ë¥˜
**ì¦ìƒ**: `Cannot find module './index.css'`

**ì›ì¸**: CSS ëª¨ë“ˆ íƒ€ì… ì„ ì–¸ì´ ì˜ëª»ë¨

**í•´ê²°**:
```typescript
// vite-env.d.ts ìˆ˜ì •
declare module "*.css" {
  const content: string;
  export default content;
}

// ìƒë‹¨ì— ì¶”ê°€
/// <reference types="vite/client" />
```

### ë¬¸ì œ 3: vitest.config.ts TypeScript ì˜¤ë¥˜
**ì¦ìƒ**: `File ... is not under 'rootDir'`

**ì›ì¸**: tsconfig.jsonì˜ rootDirì´ srcë¡œ ì„¤ì •ë˜ì–´ ìˆìŒ

**í•´ê²°**:
```json
"exclude": [
  "node_modules",
  "vitest.config.ts",
  ...
]
```

### ë¬¸ì œ 4: Sentry.Replay í˜¸í™˜ì„± ë¬¸ì œ
**ì¦ìƒ**: `Property 'Replay' does not exist on type`

**ì›ì¸**: ì„¤ì¹˜ëœ @sentry/react ë²„ì „ê³¼ Replay API í˜¸í™˜ì„± ë¬¸ì œ

**í•´ê²°**: 
```typescript
// integrations ë°°ì—´ì„ ë¹„ì›Œì„œ Replay ì œê±°
integrations: [],
```

---

## ğŸ“ˆ ì„±ëŠ¥ ì˜í–¥

### ë²ˆë“¤ í¬ê¸° ë³€í™”
- **ì¶”ê°€**: @sentry/react ë° ì˜ì¡´ì„± (~14 packages)
- **ì˜ˆìƒ ì˜í–¥**: +50~100KB (ë¯¸ë‹ˆíŒŒì´/ì••ì¶• í›„ +15~30KB)

### ëŸ°íƒ€ì„ ì„±ëŠ¥
- **ì´ì **: ì—ëŸ¬ ì¶”ì ìœ¼ë¡œ í”„ë¡œë•ì…˜ ë¬¸ì œ ì¡°ê¸° ë°œê²¬
- **ì˜¤ë²„í—¤ë“œ**: ìµœì†Œ (ë¹„ë™ê¸° ì—ëŸ¬ ì „ì†¡)

---

## ğŸš€ ë°°í¬ ì¤€ë¹„ì‚¬í•­

### í”„ë¡œë•ì…˜ ë°°í¬ ì „ ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] Sentry ê³„ì • ìƒì„± ë° í”„ë¡œì íŠ¸ ì„¤ì •
- [ ] ì‹¤ì œ Sentry DSN ë°œê¸‰
- [ ] `.env.production.local` íŒŒì¼ ìƒì„± ë° DSN ì„¤ì •
- [ ] ë¡œì»¬ì—ì„œ ì—ëŸ¬ í…ŒìŠ¤íŠ¸ (ErrorBoundary ë™ì‘ í™•ì¸)
- [ ] Sentry ëŒ€ì‹œë³´ë“œì—ì„œ ì—ëŸ¬ ìˆ˜ì‹  í™•ì¸
- [ ] ì•Œë¦¼ ê·œì¹™ ì„¤ì • (ì„ê³„ê°’, ìŠ¬ë™ ë“±)

### í™˜ê²½ë³„ ì„¤ì •

**ê°œë°œ í™˜ê²½**:
```bash
VITE_SENTRY_DSN=https://placeholder@sentry.io/123456
npm run dev
```

**í”„ë¡œë•ì…˜ í™˜ê²½**:
```bash
VITE_SENTRY_DSN=https://your_real_key@o123456.ingest.sentry.io/123456
npm run build
```

---

## ğŸ“ ì£¼ìš” ì½”ë“œ ìŠ¤ë‹ˆí«

### 1. Sentry ì´ˆê¸°í™”
```typescript
// src/main.tsx
if (typeof window !== 'undefined') {
  const SENTRY_DSN = import.meta.env.VITE_SENTRY_DSN;
  const environment = import.meta.env.MODE === 'production' ? 'production' : 'development';

  Sentry.init({
    dsn: SENTRY_DSN,
    environment: environment,
    tracesSampleRate: environment === 'production' ? 0.1 : 1.0,
  });
}
```

### 2. ErrorBoundary ì—ëŸ¬ ìº¡ì²˜
```typescript
// src/components/ErrorBoundary.tsx
componentDidCatch(error: Error, errorInfo: ErrorInfo): void {
  console.error('Error caught by boundary:', error, errorInfo);

  Sentry.captureException(error, {
    contexts: {
      react: {
        componentStack: errorInfo.componentStack,
      },
    },
  });
}
```

### 3. Appì— ì ìš©
```typescript
// src/App.tsx
<ErrorBoundary>
  <TonConnectUIProvider manifestUrl={TON_CONNECT_MANIFEST_URL}>
    {/* ì•± ì½˜í…ì¸  */}
  </TonConnectUIProvider>
</ErrorBoundary>
```

---

## ğŸ”— ê´€ë ¨ ë¬¸ì„œ

- **Instruction**: `docs/instructions/Sentry-ì—ëŸ¬-ì¶”ì -í†µí•©_20251021_150000.md`
- **Phase 1 ì „ì²´ ê³„íš**: `docs/reports/[ë³´ê³ ì„œ]_20251021_ì¢…í•©-í‰ê°€-ë°-ê°œì„ -ê¶Œê³ ì•ˆ.md`
- **Vitest í…ŒìŠ¤íŠ¸**: `docs/instructions/Vitest-í…ŒìŠ¤íŠ¸-ìë™í™”-ë„ì…_20251021_150000.md`

---

## ğŸ’¡ ì„±ê³¼ ë° ì˜ì˜

### Phase 1 ì§„í–‰ë¥ 
- âœ… Vitest í…ŒìŠ¤íŠ¸ ìë™í™” (ì™„ë£Œ)
- âœ… Sentry ì—ëŸ¬ ì¶”ì  (ì™„ë£Œ)
- â³ Rate Limiting (ë‹¤ìŒ)
- â³ í™˜ê²½ë³€ìˆ˜ ê´€ë¦¬ (ë‹¤ìŒ)

### ë¹„ì¦ˆë‹ˆìŠ¤ ê°€ì¹˜
1. **ë¹ ë¥¸ ë²„ê·¸ ê°ì§€**: í”„ë¡œë•ì…˜ ì—ëŸ¬ë¥¼ ì‹¤ì‹œê°„ìœ¼ë¡œ ì¶”ì 
2. **ì‚¬ìš©ì ê²½í—˜ ê°œì„ **: ì—ëŸ¬ ë°œìƒ ì‹œ ì¹œí™”ì ì¸ UI í‘œì‹œ
3. **ê°œë°œ íš¨ìœ¨ì„± ì¦ëŒ€**: ìë™í™”ëœ ì—ëŸ¬ ë¡œê¹…ìœ¼ë¡œ ë””ë²„ê¹… ì‹œê°„ ë‹¨ì¶•
4. **ëª¨ë‹ˆí„°ë§ ê¸°ì´ˆ êµ¬ì¶•**: í–¥í›„ ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§, ì„¸ì…˜ ì¬ìƒ ë“± í™•ì¥ ê°€ëŠ¥

---

**ì™„ë£Œ ì‹œê°„**: 2025-10-21 15:00  
**ìƒíƒœ**: âœ… ê²€ì¦ ì™„ë£Œ ë° í”„ë¡œë•ì…˜ ì¤€ë¹„  
**ë‹¤ìŒ ì‘ì—…**: Rate Limiting ì ìš© (Phase 1-3)
