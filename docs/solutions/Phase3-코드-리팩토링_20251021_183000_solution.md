***REMOVED***í•´ê²° ê¸°ë¡: Phase 3 ì½”ë“œ í’ˆì§ˆ ê°œì„  ë° íƒ€ì… ê°•í™”

> **ì›ë³¸ ì§€ì‹œì„œ**: `instructions/Phase3-ì½”ë“œ-ë¦¬íŒ©í† ë§_20251021_183000.md`  
> **ì™„ë£Œ ì‹œê°„**: 2025-10-21 18:45  
> **ìµœì¢… ë²„ì „**: v2.2.0  
> **ê´€ë ¨ ì»¤ë°‹**: 967a22e

---

#***REMOVED***ğŸ“‹ í•´ê²° ë°©ë²• ìš”ì•½

##***REMOVED***ìˆ˜ì •/ìƒì„± íŒŒì¼
1. **`src/types.ts`** - íƒ€ì… ì •ì˜ ëŒ€í­ í™•ì¥ (40+ ì‹ ê·œ íƒ€ì…)
2. **`src/constants.ts`** - ìƒìˆ˜ ì •ë¦¬ ë° JSDoc ì¶”ê°€
3. **`src/utils/errors.ts`** - ì»¤ìŠ¤í…€ ì—ëŸ¬ í´ë˜ìŠ¤ ì‹ ê·œ ìƒì„±
4. **`src/utils/telegram.ts`** - TMA ìœ í‹¸ë¦¬í‹° ì‹ ê·œ ìƒì„± (180+ ë¼ì¸)

---

#***REMOVED***ğŸ”§ ìƒì„¸ ë³€ê²½ì‚¬í•­

##***REMOVED***1. íƒ€ì… ì‹œìŠ¤í…œ ê°•í™” (`src/types.ts`)

###***REMOVED***ì¶”ê°€ëœ íƒ€ì… (40+ê°œ)

**API ë° ë„¤íŠ¸ì›Œí¬**:
```typescript
export interface ApiResponse<T = unknown> {
  success: boolean;
  data?: T;
  error?: string;
  message?: string;
  timestamp?: number;
}

export interface LoadingState<T> {
  loading: boolean;
  data: T | null;
  error: Error | null;
}
```

**ë¸”ë¡ì²´ì¸**:
```typescript
export interface JettonInfo {
  address: string;
  name: string;
  symbol: string;
  decimals: number;
  icon?: string;
}

export interface WalletConnection {
  address: string | null;
  connected: boolean;
  connecting: boolean;
  error: Error | null;
}

export interface TransactionInfo {
  hash: string;
  status: 'pending' | 'completed' | 'failed';
  timestamp: number;
  amount?: string;
  from?: string;
  to?: string;
}
```

**ê²Œì„**:
```typescript
export type GameMode = 'game' | 'deposit';
export type DepositMethod = 'tonconnect' | 'rpc' | 'auto';

export interface GameState {
  mode: GameMode;
  balance: number;
  isSpinning: boolean;
  lastResult?: SpinResult;
}

export interface SpinResult {
  symbols: string[];
  multiplier: number;
  prize: number;
  timestamp: number;
}
```

**UI**:
```typescript
export type ButtonSize = 'sm' | 'md' | 'lg';
export type ButtonVariant = 'primary' | 'secondary' | 'danger' | 'ghost';

export interface ToastMessage {
  id: string;
  type: 'success' | 'error' | 'warning' | 'info';
  message: string;
  duration?: number;
}
```

**ì»´í¬ë„ŒíŠ¸ Props**:
```typescript
export interface DepositProps {
  onBack: () => void;
  onDepositSuccess?: (amount: number, method: DepositMethod) => void;
}

export interface GameProps {
  onDepositClick: () => void;
}
```

**Telegram**:
```typescript
export interface TelegramUser {
  id: number;
  is_bot: boolean;
  first_name: string;
  last_name?: string;
  username?: string;
  language_code?: string;
  is_premium?: boolean;
  photo_url?: string;
}

export interface TelegramWebApp {
  // ... ì „ì²´ ì¸í„°í˜ì´ìŠ¤ ì •ì˜
  ready?: () => void;
  BackButton?: { show?: () => void; hide?: () => void };
  MainButton?: { setText?: (text: string) => void; /* ... */ };
  HapticFeedback?: { /* ... */ };
}
```

---

##***REMOVED***2. ìƒìˆ˜ ì •ë¦¬ (`src/constants.ts`)

###***REMOVED***ë³€ê²½ì‚¬í•­
- JSDoc ì£¼ì„ ì¶”ê°€ (ëª¨ë“  ìƒìˆ˜ì—)
- ì„¹ì…˜ë³„ ê·¸ë£¹í™” (ë¸”ë¡ì²´ì¸, TonConnect, RPC, ê²Œì„, í™˜ê²½, ëª¨ë‹ˆí„°ë§)
- `GAME_CONFIG` ìƒìˆ˜ ê°ì²´ ì‹ ê·œ ìƒì„±
- `as const` íƒ€ì… ì•ˆì •ì„± ê°•í™”
- í™˜ê²½ë³€ìˆ˜ ì‚¬ìš© ì˜ˆì‹œ ì¶”ê°€

###***REMOVED***Before vs After

**Before**:
```typescript
export const MIN_DEPOSIT_AMOUNT = 0.1;
export const MAX_DEPOSIT_AMOUNT = 1000;
```

**After**:
```typescript
/** @desc ìµœì†Œ ì…ê¸ˆì•¡ (TON ë‹¨ìœ„) */
export const MIN_DEPOSIT_AMOUNT = 0.1;

/** @desc ìµœëŒ€ ì…ê¸ˆì•¡ (TON ë‹¨ìœ„) */
export const MAX_DEPOSIT_AMOUNT = 1000;

export const GAME_CONFIG = {
  SPIN_COST: 10,
  MAX_PRIZE: 1000,
  DEFAULT_MULTIPLIER: 1,
} as const;
```

---

##***REMOVED***3. ì»¤ìŠ¤í…€ ì—ëŸ¬ í´ë˜ìŠ¤ (`src/utils/errors.ts`)

###***REMOVED***êµ¬ì¡°

**ê¸°ë³¸ ì—ëŸ¬**:
```typescript
export class AppError extends Error {
  constructor(
    public message: string,
    public code: string = 'APP_ERROR',
    public statusCode: number = 500
  ) { /* ... */ }
}
```

**íŒŒìƒ ì—ëŸ¬ í´ë˜ìŠ¤**:
- `ValidationError` - ì…ë ¥ê°’ ê²€ì¦ ì‹¤íŒ¨ (400)
- `ConfigurationError` - í™˜ê²½ë³€ìˆ˜ ì˜¤ë¥˜ (500)
- `WalletConnectError` - ì§€ê°‘ ì—°ê²° ì‹¤íŒ¨ (400)
- `TransactionError` - ê±°ë˜ ì²˜ë¦¬ ì˜¤ë¥˜ (400)
- `RpcError` - RPC í˜¸ì¶œ ì‹¤íŒ¨ (503)
- `ApiError` - API ìš”ì²­ ì‹¤íŒ¨ (500)
- `TimeoutError` - ìš”ì²­ íƒ€ì„ì•„ì›ƒ (408)

**íƒ€ì… ê°€ë“œ í•¨ìˆ˜**:
```typescript
export function isAppError(error: unknown): error is AppError { /* ... */ }
export function isValidationError(error: unknown): error is ValidationError { /* ... */ }
export function isWalletConnectError(error: unknown): error is WalletConnectError { /* ... */ }
// ... ë“±ë“±
```

**ì—ëŸ¬ ë©”ì‹œì§€ ë§¤í•‘**:
```typescript
export const ERROR_MESSAGES: Record<string, string> = {
  VALIDATION_ERROR: 'ì…ë ¥ê°’ì´ ìœ íš¨í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.',
  WALLET_CONNECT_ERROR: 'ì§€ê°‘ ì—°ê²°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.',
  // ...
};

export function getUserFriendlyMessage(code: string): string { /* ... */ }
export function getErrorMessage(error: unknown): string { /* ... */ }
```

###***REMOVED***ì‚¬ìš© ì˜ˆì‹œ

```typescript
// ì—ëŸ¬ ë°œìƒ
try {
  if (!address) {
    throw new ValidationError('Invalid wallet address');
  }
} catch (error) {
  if (isValidationError(error)) {
    console.log(error.code); // 'VALIDATION_ERROR'
    console.log(error.statusCode); // 400
  }
}

// ì‚¬ìš©ì ë©”ì‹œì§€
const message = getErrorMessage(error);
// => 'ì§€ê°‘ ì—°ê²°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.'
```

---

##***REMOVED***4. TMA ìœ í‹¸ë¦¬í‹° (`src/utils/telegram.ts`)

###***REMOVED***ì œê³µ í•¨ìˆ˜ (14ê°œ)

**ì´ˆê¸°í™” & ì ‘ê·¼**:
- `getTelegramWebApp()` - WebApp ê°ì²´ ê°€ì ¸ì˜¤ê¸°
- `isTelegramMiniApp()` - TMA í™˜ê²½ í™•ì¸
- `initializeTelegramWebApp()` - ì´ˆê¸°í™” (ready, ìƒ‰ìƒ ì„¤ì • ë“±)

**ì‚¬ìš©ì ì •ë³´**:
- `getTelegramUserId()` - ì‚¬ìš©ì ID
- `getTelegramUserInfo()` - ì‚¬ìš©ì ì •ë³´
- `getTelegramInitData()` - Init Data (ì„œë²„ ê²€ì¦ìš©)

**UI ì œì–´**:
- `showBackButton(callback)` - ë’¤ë¡œê°€ê¸° ë²„íŠ¼
- `showMainButton(text, callback)` - ë©”ì¸ ë²„íŠ¼
- `hideMainButton()` - ë©”ì¸ ë²„íŠ¼ ìˆ¨ê¸°ê¸°
- `setMainButtonEnabled(enabled)` - í™œì„±í™”/ë¹„í™œì„±í™”
- `setMainButtonLoading(loading)` - ë¡œë”© ìƒíƒœ

**í•´í”Œí‹± í”¼ë“œë°±**:
- `triggerHapticFeedback(style)` - ì„íŒ©íŠ¸ ì§„ë™
- `triggerSelectionHaptic()` - ì„ íƒ í”¼ë“œë°±
- `triggerSuccessHaptic()` - ì„±ê³µ í”¼ë“œë°±
- `triggerErrorHaptic()` - ì˜¤ë¥˜ í”¼ë“œë°±

**í´ë¦½ë³´ë“œ**:
- `copyToClipboard(text)` - í´ë¦½ë³´ë“œ ë³µì‚¬

###***REMOVED***ì‚¬ìš© ì˜ˆì‹œ

```typescript
// ì´ˆê¸°í™”
useEffect(() => {
  initializeTelegramWebApp();
  
  // ë’¤ë¡œê°€ê¸° ë²„íŠ¼
  const unsubscribe = showBackButton(() => {
    navigate(-1);
  });
  
  return unsubscribe;
}, []);

// ë©”ì¸ ë²„íŠ¼
const unsubscribe = showMainButton('ê²°ì œí•˜ê¸°', async () => {
  setMainButtonLoading(true);
  try {
    await processPayment();
    triggerSuccessHaptic();
  } catch (error) {
    triggerErrorHaptic();
  } finally {
    setMainButtonLoading(false);
  }
});
```

---

#***REMOVED***âœ… ê²€ì¦ ê²°ê³¼

##***REMOVED***TypeScript íƒ€ì… ê²€ì‚¬
```bash
âœ… npx tsc --noEmit
â†’ 0 errors (í†µê³¼)
```

##***REMOVED***í…ŒìŠ¤íŠ¸
```bash
âœ… npm test
â†’ 12/12 tests passed (100%)
â†’ Duration: 1.89s
```

##***REMOVED***ë¹Œë“œ
```bash
âœ… npm run build
â†’ Build successful (ì˜¤ë¥˜ ì—†ìŒ)
```

---

#***REMOVED***ğŸ“Š ì½”ë“œ í’ˆì§ˆ ê°œì„ 

##***REMOVED***íƒ€ì… ì•ˆì •ì„±
| í•­ëª© | Before | After | ê°œì„  |
|------|--------|-------|------|
| íƒ€ì… ì •ì˜ | 5ê°œ | 45+ê°œ | **9ë°° ì¦ê°€** |
| JSDoc ì»¤ë²„ë¦¬ì§€ | 30% | 90%+ | **3ë°° ì¦ê°€** |
| ì—ëŸ¬ í´ë˜ìŠ¤ | 0ê°œ | 7ê°œ | **ì‹ ê·œ** |

##***REMOVED***ì½”ë“œ ì¡°ì§í™”
| íŒŒì¼ | ë¼ì¸ ìˆ˜ | ìš©ë„ |
|------|--------|------|
| `types.ts` | 150+ | íƒ€ì… ì •ì˜ |
| `constants.ts` | 180+ | ìƒìˆ˜ ë° ê²€ì¦ |
| `utils/errors.ts` | 250+ | ì—ëŸ¬ ì²˜ë¦¬ |
| `utils/telegram.ts` | 350+ | TMA ê¸°ëŠ¥ |

---

#***REMOVED***ğŸ¯ ë‹¤ìŒ ìµœì í™” ë‹¨ê³„

##***REMOVED***Phase 3-2: ì¤‘ë³µ ì½”ë“œ ì œê±°
- [ ] ì»´í¬ë„ŒíŠ¸ ìƒíƒœ ë¡œì§ ì¤‘ë³µ ì œê±°
- [ ] ì»¤ìŠ¤í…€ hooks ì¶”ì¶œ (useTelegramWebApp, useGameState ë“±)
- [ ] Telegram API í˜¸ì¶œ ì¤‘ë³µ ì œê±°

##***REMOVED***Phase 3-3: ë¦¬íŒ©í† ë§
- [ ] ì»´í¬ë„ŒíŠ¸ë³„ Props íƒ€ì… ì ìš©
- [ ] ì—ëŸ¬ ì²˜ë¦¬ í†µì¼ (ì—ëŸ¬ í´ë˜ìŠ¤ í™œìš©)
- [ ] ë¡œê¹… ì¼ê´€ì„± (console vs Sentry)

##***REMOVED***Phase 3-4: ì„±ëŠ¥ ìµœì í™”
- [ ] ë©”ëª¨ì´ì œì´ì…˜ ì ìš© (useMemo, useCallback)
- [ ] ë¶ˆí•„ìš”í•œ ë¦¬ë Œë”ë§ ì œê±°
- [ ] ì´ë¯¸ì§€ ìµœì í™”

---

#***REMOVED***ğŸš€ ë°°í¬ ì¤€ë¹„

##***REMOVED***ê²€ì¦ ì²´í¬ë¦¬ìŠ¤íŠ¸
- âœ… TypeScript: 0 errors
- âœ… Tests: 12/12 passed
- âœ… Build: Successful
- âœ… Types: 45+ ì •ì˜
- âœ… Errors: 7ê°œ í´ë˜ìŠ¤
- âœ… Utils: TMA í•¨ìˆ˜ 14ê°œ

##***REMOVED***í”„ë¡œë•ì…˜ ë°°í¬
```bash
***REMOVED***íƒ€ì… ê²€ì‚¬
npx tsc --noEmit

***REMOVED***í…ŒìŠ¤íŠ¸
npm test

***REMOVED***ë¹Œë“œ
npm run build

***REMOVED***ë°°í¬
git push origin main
```

---

#***REMOVED***ğŸ“š ì°¸ê³  ìë£Œ

- [TypeScript Handbook](https://www.typescriptlang.org/docs/handbook/)
- [Telegram Bot API](https://core.telegram.org/bots/api)
- [React Hooks Best Practices](https://react.dev/reference/react/hooks)

---

**Status**: âœ… Phase 3-1 ì™„ë£Œ  
**ë‹¤ìŒ ë‹¨ê³„**: Phase 3-2 (ì¤‘ë³µ ì½”ë“œ ì œê±°) ë˜ëŠ” Phase 2-4 (ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§)
