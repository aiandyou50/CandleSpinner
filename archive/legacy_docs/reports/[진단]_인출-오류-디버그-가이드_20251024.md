***REMOVED***β… μΈμ¶ μ¤λ¥ λ¶„μ„ λ° ν•΄κ²° λ°©μ• - μµμΆ… λ³΄κ³ μ„

> **μ‘μ„±μΌ:** 2025λ…„ 10μ›” 24μΌ  
> **ν„μ¬ λ°°ν¬:** v2.5.0 (λ°©κΈ μ—…λ°μ΄νΈ)  
> **μƒνƒ:** πΆ λ””λ²„κ·Έ API λ°°ν¬ μ™„λ£, μ§„λ‹¨ μ¤€λΉ„ μ™„λ£

---

#***REMOVED***π― **λ¬Έμ  μƒν™© μ”μ•½**

##***REMOVED*****μ¦μƒ**
```
λΈλΌμ°μ €: POST /api/initiate-withdrawal β†’ HTTP 500 μ¤λ¥
μ›μΈ: κ°μΈν‚¤ λ¶μΌμΉ (μ΄μ „ AI μ¶”λ΅ )
```

##***REMOVED*****ν™•μΈλ μƒνƒ**
β… GAME_WALLET_PRIVATE_KEY - ν™κ²½λ³€μ μ„¤μ •λ¨  
β… GAME_WALLET_ADDRESS - ν™κ²½λ³€μ μ„¤μ •λ¨  
β… CSPIN_TOKEN_ADDRESS - ν™κ²½λ³€μ μ„¤μ •λ¨  
β… CREDIT_KV - λ°”μΈλ”© μ„¤μ •λ¨  

---

#***REMOVED***π“΅ **μ§„λ‹¨ λ„κµ¬ κµ¬μ¶• μ™„λ£**

##***REMOVED*****π”— λ””λ²„κ·Έ URL**
```
https://aiandyou.me/api/debug-withdrawal
```

**λΈλΌμ°μ €μ—μ„ μ§μ ‘ μ ‘μ†ν•λ©΄:**
```json
{
  "timestamp": "2025-10-24T...",
  "environment": {
    "hasPrivateKey": true/false,        // β† κ°μΈν‚¤ μ„¤μ • μ—¬λ¶€
    "privateKeyMasked": "4e6568d1...ef7978fc",
    "gameWalletAddress": "UQB...",
    "cspinTokenAddress": "EQB..."
  },
  "status": {
    "privateKeyValid": true/false,      // β† 128μ hex ν•μ‹ ν™•μΈ
    "gameWalletValid": true/false,
    "cspinTokenValid": true/false
  },
  "addressMatch": {
    "match": true/false,                // β† π”΄ ν•µμ‹¬: falseλ©΄ κ°μΈν‚¤ λ¶μΌμΉ!
    "envAddress": "UQB...",
    "calculatedAddress": "UQB...",
    "note": "β… κ°μΈν‚¤μ™€ μ£Όμ†κ°€ μΌμΉν•©λ‹λ‹¤" λλ”
            "β κ²½κ³ : κ°μΈν‚¤μ™€ μ£Όμ†κ°€ λ¶μΌμΉ! κ°μΈν‚¤λ¥Ό λ‹¤μ‹ ν™•μΈν•μ„Έμ”"
  },
  "seqno": {
    "current": 0,                       // β† λ‹¤μ νΈλμ­μ… μ‹ν€€μ¤ λ²νΈ
    "note": "β… μ„¤μ •λ¨" λλ” "β οΈ λ―Έμ„¤μ •"
  },
  "lastError": {                        // β† μµκ·Ό μΈμ¶ μ¤λ¥
    "timestamp": "...",
    "error": "μ¤λ¥ λ©”μ‹μ§€",
    "walletAddress": "...",
    "withdrawalAmount": 100
  }
}
```

---

#***REMOVED***π” **λ¶„μ„ μ μ°¨ (λ‹¨κ³„λ³„)**

##***REMOVED*****Step 1: λ””λ²„κ·Έ API μ ‘μ†**
```
1. λΈλΌμ°μ €μ—μ„ https://aiandyou.me/api/debug-withdrawal μ—΄κΈ°
2. JSON μ‘λ‹µ μ „μ²΄λ¥Ό λ³µμ‚¬
```

##***REMOVED*****Step 2: addressMatch ν™•μΈ**
```json
"addressMatch": {
  "match": ___,  // β† μ΄ κ°’μ„ ν™•μΈ!
  "envAddress": "UQB...",
  "calculatedAddress": "UQB..."
}
```

**λ§μ•½ `match: false`λΌλ©΄:**
```
β κ°μΈν‚¤κ°€ ν™κ²½λ³€μμ μ£Όμ†μ™€ μΌμΉν•μ§€ μ•μµλ‹λ‹¤!

μ›μΈ:
1. κ°μΈν‚¤κ°€ μλ»λ¨ (λ³µμ‚¬ μ¤λ¥)
2. κ°μΈν‚¤λ¥Ό λ³€κ²½ν–μ§€λ§ μ£Όμ†λ¥Ό μ—…λ°μ΄νΈν•μ§€ μ•μ
3. κ°μΈν‚¤κ°€ λ‹¤λ¥Έ μ§€κ°‘μ ν‚¤μ„

ν•΄κ²°:
β†’ λ‹¤μ μ„Ήμ… "κ°μΈν‚¤ λ¶μΌμΉ ν•΄κ²° λ°©λ²•" μ°Έμ΅°
```

**λ§μ•½ `match: true`λΌλ©΄:**
```
β… κ°μΈν‚¤μ™€ μ£Όμ†κ°€ μΌμΉν•©λ‹λ‹¤.
β†’ λ¬Έμ λ” λ‹¤λ¥Έ κ³³μ— μμµλ‹λ‹¤.
β†’ lastError μ„Ήμ…μ„ ν™•μΈν•μ„Έμ”.
```

---

#***REMOVED***π”§ **κ°μΈν‚¤ λ¶μΌμΉ ν•΄κ²° λ°©λ²•**

##***REMOVED*****μ›μΈ λ¶„μ„**
κ°μΈν‚¤λ΅λ¶€ν„° κ³„μ‚°λ κ³µκ°ν‚¤κ°€ λ‹¤λ¥Έ μ£Όμ†λ¥Ό μƒμ„±ν•λ‹¤λ©΄:

```
Game Private Key (env)
    β†“ (keyPairFromSecretKey)
κ³µκ°ν‚¤ κ³„μ‚°
    β†“ (WalletContractV5R1.create)
μ§€κ°± μ£Όμ† κ³„μ‚°: "UQB..." (κ³„μ‚°κ°’)
    β†‘
    λΉ„κµ
    β†“
ν™κ²½λ³€μμ μ£Όμ†: "UQB..." (μ„¤μ •κ°’)

λ§μ•½ λ¶μΌμΉ β†’ β κ°μΈν‚¤κ°€ μλ»λ¨
```

##***REMOVED*****ν•΄κ²° μ μ°¨**

###***REMOVED*****Case 1: κ°μΈν‚¤κ°€ μλ»λ κ²½μ°**

**Step 1: μ¬λ°”λ¥Έ κ°μΈν‚¤ μƒμ„±**
```bash
***REMOVED***PowerShellμ—μ„λ§ μ‹¤ν–‰ (Git Bash κΈμ§€)
cd wallet-tools
node mnemonic-to-key.mjs "your-24-word-mnemonic-phrase-here"

***REMOVED***μ¶λ ¥ μμ‹:
***REMOVED***privateKey: 4e6568d1990bff34c3fc...ef7978fc
***REMOVED***publicKey: 3a59677f67586df6a530...
***REMOVED***walletAddress: UQBFPDdSlPgqPrn2XwhpVq0KQExN2kv83_batQ-dptaR8Mtd
```

**Step 2: μ¶λ ¥λ κ°’ ν™•μΈ**
```
privateKeyμ™€ walletAddressλ¥Ό κΈ°λ΅ν•΄λ‘μ„Έμ”.
(λ‹¤λ¥Έ μ‚¬λμ—κ² μ λ€ κ³µμ ν•μ§€ λ§μ„Έμ”!)
```

**Step 3: Cloudflare ν™κ²½λ³€μ μ—…λ°μ΄νΈ**
```
Cloudflare λ€μ‹λ³΄λ“
  β†’ Pages β†’ Candlespinner β†’ Settings
  β†’ Environment variables
  β†’ Production νƒ­

κΈ°μ΅΄ κ°’μ„ λ‹¤μμΌλ΅ λ³€κ²½:
  GAME_WALLET_PRIVATE_KEY: [Step 1μ privateKey]
  GAME_WALLET_ADDRESS: [Step 1μ walletAddress]
```

**Step 4: νμ¤ν† λ¦¬ μ •λ¦¬**
```powershell
***REMOVED***PowerShell λ…λ Ήμ–΄ νμ¤ν† λ¦¬ μ‚­μ 
Clear-History
Remove-Item (Get-PSReadlineOption).HistorySavePath -Force
```

**Step 5: λ°°ν¬ λ€κΈ°**
```
Cloudflareκ°€ μλ™μΌλ΅ μ¬λ°°ν¬ν•©λ‹λ‹¤. (μ•½ 2-3λ¶„)
μ¬λ°°ν¬ ν™•μΈ:
  Cloudflare λ€μ‹λ³΄λ“ β†’ Deployments νƒ­
```

---

###***REMOVED*****Case 2: κ°μΈν‚¤λ” λ§λ”λ° μ£Όμ†κ°€ λ‹¤λ¥Έ κ²½μ°**

**μ›μΈ:** 
- κ°μΈν‚¤λ” λ§μ§€λ§ ν™κ²½λ³€μμ μ£Όμ†κ°€ μλ»λ¨
- λλ” μ΄μ „ μ£Όμ†λ¥Ό μ—¬μ „ν μ‚¬μ© μ¤‘

**ν•΄κ²°:**
```
1. wallet-tools/mnemonic-to-key.mjsλ΅ μƒμ„±λ walletAddress ν™•μΈ
2. Cloudflareμ—μ„ GAME_WALLET_ADDRESSλ¥Ό κ·Έ μ£Όμ†λ΅ μ—…λ°μ΄νΈ
3. λ°°ν¬ λ€κΈ°
```

---

#***REMOVED***π“ **λ‹¤μ μ§„λ‹¨ μ μ°¨**

##***REMOVED*****1οΈβƒ£ μ§€κΈ λ°”λ΅ ν•΄μ•Ό ν•  κ²ƒ**

```
1. https://aiandyou.me/api/debug-withdrawal μ ‘μ†
2. JSON μ‘λ‹µμ—μ„ "addressMatch.match" κ°’ ν™•μΈ:
   - true  β†’ κ°μΈν‚¤ μΌμΉ β…
   - false β†’ κ°μΈν‚¤ λ¶μΌμΉ β
3. κ²°κ³Όλ¥Ό μ•λ ¤μ£Όμ„Έμ”
```

##***REMOVED*****2οΈβƒ£ addressMatch.matchκ°€ falseλΌλ©΄**

```
μ„μ "κ°μΈν‚¤ λ¶μΌμΉ ν•΄κ²° λ°©λ²•"μ„ λ”°λ¥΄μ„Έμ”.
```

##***REMOVED*****3οΈβƒ£ addressMatch.matchκ°€ trueλΌλ©΄**

```
κ°μΈν‚¤λ” μ •μƒμ…λ‹λ‹¤.
λ‹¤λ¥Έ μ›μΈμ„ λ¶„μ„ν•΄μ•Ό ν•©λ‹λ‹¤:

1. lastError μ„Ήμ… ν™•μΈ β†’ μµκ·Ό μ¤λ¥ λ©”μ‹μ§€
2. λ‹¤μ‹ μΈμ¶ μ‹λ„
3. μƒλ΅μ΄ μ¤λ¥ λ©”μ‹μ§€ ν™•μΈ
```

---

#***REMOVED***π’Ύ **μ €μ¥λ λ¬Έμ„**

| νμΌ | λ©μ  |
|------|------|
| `docs/reports/[κΈ΄κΈ‰]_μΈμ¶-μ¤λ¥-λ¶„μ„_20251024.md` | μ΄κΈ° λ¶„μ„ (κ°€λ¥ν• μ›μΈ λ©λ΅) |
| `functions/api/debug-withdrawal.ts` | λ””λ²„κ·Έ API μ½”λ“ |
| λ³Έ λ¬Έμ„ | μ§„λ‹¨ λ° ν•΄κ²° κ°€μ΄λ“ |

---

#***REMOVED***π€ **λ°°ν¬ μƒνƒ**

```
β… debug-withdrawal API μ¶”κ°€ μ™„λ£
β… Git μ»¤λ°‹ μ™„λ£ (2cf1452)
β… GitHub push μ™„λ£
πΆ Cloudflare Pages μλ™ λ°°ν¬ μ‹μ‘ (μ•½ 2-3λ¶„)
```

**λ°°ν¬ ν™•μΈ:**
```
Cloudflare λ€μ‹λ³΄λ“
  β†’ Pages β†’ Candlespinner β†’ Deployments
  β†’ μµμ‹  λ°°ν¬ μƒνƒ ν™•μΈ
```

λ°°ν¬ μ™„λ£ ν›„: https://aiandyou.me/api/debug-withdrawal μ ‘μ† κ°€λ¥

---

#***REMOVED***π“ **μ²΄ν¬λ¦¬μ¤νΈ**

**μ§€κΈ λ°”λ΅:**
```
β–΅ https://aiandyou.me/api/debug-withdrawal μ ‘μ†
β–΅ addressMatch.match κ°’ ν™•μΈ (true/false)
β–΅ κ²°κ³Όλ¥Ό λ‚μ—κ² μ•λ ¤μ£ΌκΈ°
```

**addressMatch.matchκ°€ falseμΈ κ²½μ°:**
```
β–΅ wallet-tools/mnemonic-to-key.mjs μ‹¤ν–‰
β–΅ μƒ privateKeyμ™€ walletAddress νλ“
β–΅ Cloudflare ν™κ²½λ³€μ μ—…λ°μ΄νΈ
β–΅ νμ¤ν† λ¦¬ μ •λ¦¬ (Clear-History)
β–΅ λ°°ν¬ λ€κΈ° (2-3λ¶„)
β–΅ https://aiandyou.me/api/debug-withdrawal μ¬ν™•μΈ
```

---

#***REMOVED***β¨ **μ”μ•½**

ν„μ¬ μƒν™©:
1. β… λ¨λ“  ν™κ²½λ³€μ μ„¤μ •λ¨
2. β… λ””λ²„κ·Έ API λ°°ν¬ μ™„λ£
3. π΅ κ°μΈν‚¤ μΌμΉ μ—¬λ¶€λ” **μ•„μ§ λ―Έν™•μΈ**

**λ‹¤μ λ‹¨κ³„:**
β†’ https://aiandyou.me/api/debug-withdrawal μ ‘μ†ν•μ—¬ addressMatch.match ν™•μΈ

---

**μ¤€λΉ„ μ™„λ£! λ””λ²„κ·Έ APIμ— μ ‘μ†ν•΄μ„ κ²°κ³Όλ¥Ό μ•λ ¤μ£Όμ„Έμ”.** π€
