## **[산출물 2] 기술 스택 및 아키텍처 설계 (Tech Stack & Architecture)**

  * **프로젝트명:** CandleSpinner
  * **버전:** 1.0
  * **작성일:** 2025년 10월 16일
  * **목표:** 확장 가능하고, 개발 생산성이 높으며, 서버리스 환경에 최적화된 기술 스택을 정의한다.

### **1. 시스템 아키텍처 다이어그램 (System Architecture Diagram)**

```
┌──────────────────┐      ┌───────────────────────────┐      ┌────────────────────────┐
│   User's Device  │      │     Cloudflare Network    │      │      TON Blockchain    │
│ (Web Browser)    ├──────▶ (Frontend on Pages)       ├──────▶ (Smart Contracts &   │
└──────────────────┘      │                           │      │   User's TON Wallet)   │
         ▲                │ (Backend on Workers)      │      └────────────────────────┘
         │                └───────────┬───────────────┘
         │                            │
         │                            │
         └────────────────────────────┘
(User Interaction)      (Off-chain Logic & API)         (On-chain Transactions)

```

  * **User's Device:** 사용자가 모바일 또는 PC 브라우저를 통해 게임에 접속합니다.
  * **Cloudflare Network:**
      * **Frontend (Pages):** 사용자에게 보여지는 모든 시각적 요소(UI, 애니메이션)를 담당하는 정적 웹사이트입니다.
      * **Backend (Workers):** 게임의 핵심 로직(베팅 처리, 확률 계산 등)을 처리하는 서버리스 함수입니다.
  * **TON Blockchain:** 실제 자산(`CSPIN` 토큰)의 입금 및 인출을 처리하는 탈중앙화 네트워크입니다.

-----

### **2. 프론트엔드 (Frontend)**

사용자 인터페이스와 경험을 담당하는 영역입니다.

  * **개발 프레임워크: React (with Vite)**
      * **선택 이유:** 가장 큰 개발자 생태계를 보유하고 있어 라이브러리 및 레퍼런스 확보가 용이합니다. Vite를 빌드 도구로 사용하여 매우 빠른 개발 서버 속도와 최적화된 빌드 결과를 보장합니다.
  * **그래픽 및 애니메이션: PixiJS**
      * **선택 이유:** WebGL 기반의 고성능 2D 렌더링 라이브러리로, 슬롯머신의 부드러운 릴(Reel) 회전 및 화려한 당첨 효과를 구현하는 데 최적화되어 있습니다.
  * **UI 컴포넌트 및 스타일링: Tailwind CSS & shadcn/ui**
      * **선택 이유:** 유틸리티 우선(Utility-first) 접근 방식으로 신속하게 UI를 구축할 수 있습니다. `shadcn/ui`를 통해 미리 디자인된 고품질 컴포넌트(버튼, 입력 필드 등)를 손쉽게 커스터마이징하여 네온사인 컨셉을 구현합니다.
  * **상태 관리: Zustand**
      * **선택 이유:** 매우 가볍고 간단한 API를 제공하여 React의 상태 관리를 쉽게 만들어 줍니다. 사용자의 게임 크레딧, 베팅 금액 등 전역적으로 관리되어야 할 상태를 효율적으로 처리합니다.
  * **다국어 지원(i18n): i18next**
      * **선택 이유:** React 환경에서 가장 널리 사용되는 국제화 라이브러리로, 정의서에 명시된 7개 언어를 체계적으로 관리하고 동적으로 변경하는 기능을 제공합니다.

-----

### **3. 백엔드 (Backend - Serverless)**

오프체인 게임 로직을 처리하는 서버 영역입니다.

  * **플랫폼: Cloudflare Workers**
      * **선택 이유:** 글로벌 엣지 네트워크에서 코드를 실행하여 전 세계 어디서든 매우 빠른 응답 속도를 제공합니다. 별도의 서버 관리 없이 코드 배포만으로 운영이 가능합니다.
  * **언어: TypeScript**
      * **선택 이유:** 정적 타입을 지원하여 코드의 안정성을 높이고, 프론트엔드와 동일한 언어를 사용하여 개발 생산성을 극대화합니다.
  * **핵심 API 엔드포인트:**
      * `/api/spin`: 사용자의 베팅 요청을 받아 Provably Fair 알고리즘으로 스핀 결과를 생성하고 반환합니다.
      * `/api/double-up`: 미니게임 요청을 받아 50% 확률의 성공/실패 결과를 반환합니다.
      * `/api/state`: 사용자의 현재 게임 크레딧 상태를 조회합니다.
  * **오프체인 데이터 저장소: Cloudflare KV**
      * **선택 이유:** Cloudflare Workers에 최적화된 초저지연 Key-Value 저장소입니다. 사용자의 지갑 주소를 Key로, 현재 보유 크레딧을 Value로 저장하여 오프체인 잔액을 관리하는 데 가장 이상적입니다. (예: `{'UQBF...R8Mtd': { credit: 5000 }}`)

-----

### **4. 블록체인 연동 (Blockchain Integration)**

웹 애플리케이션과 TON 블록체인을 연결하는 영역입니다.

  * **지갑 연결 UI: `@tonconnect/ui-react`**
      * **선택 이유:** TON 공식 라이브러리로, 'Wallet 연결' 버튼과 QR 코드 모달 등 TON Connect 표준 UI를 단 몇 줄의 코드로 손쉽게 구현할 수 있습니다.
  * **트랜잭션 생성 및 전송: `ton-core`, `ton-crypto`**
      * **선택 이유:** TON 블록체인의 트랜잭션을 구성하고 서명을 요청하는 핵심 라이브러리입니다. 프론트엔드에서 이 라이브러리들을 사용하여 CSPIN 토큰의 입금(Deposit) 및 인출(Withdraw) 트랜잭션 메시지를 생성하고, 사용자의 지갑에 전송하여 서명을 요청하게 됩니다.

-----

### **5. 개발 및 배포 (CI/CD Pipeline)**

  * **소스 코드 관리: GitHub**
      * **역할:** 모든 프론트엔드 및 백엔드(Worker) 코드를 관리하는 중앙 저장소.
  * **자동 빌드 및 배포: Cloudflare Pages GitHub Integration**
      * **작동 방식:**
        1.  개발자가 `main` 브랜치에 코드를 `git push` 합니다.
        2.  GitHub이 변경 사항을 Cloudflare Pages에 자동으로 알립니다.
        3.  Cloudflare Pages는 최신 코드를 가져와 React 앱을 빌드(정적 파일 생성)하고, Worker 코드를 함께 패키징합니다.
        4.  빌드가 성공하면, 새로운 버전이 전 세계 Cloudflare 엣지 네트워크에 수 분 내로 배포 완료됩니다.